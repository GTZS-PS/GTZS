<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GTZS Private Server - Mobile Optimized & Clean</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/tsparticles@2.12.0/tsparticles.bundle.min.js"></script>

<style>
/* ===== KONTEN UTAMA - DIBATASI UNTUK RUMUS 9:16 (MOBILE) ===== */
/* FIX 1: BASE FONT dan Matrix Background */
body {
    font-family: 'Rajdhani', sans-serif;
    overflow-x: hidden;
}

/* ===== NEW: ROOT COLOR VARIABLES ===== */
:root {
    --color-primary: #00e6ff; /* Cyan Default */
    --color-secondary: #ff00d4; /* Magenta Default */
    --color-success: #00ff90; /* Green */
    --color-warning: #ff8c00; /* Orange */
}

/* FIX 2: Data Stream/Matrix Background (TETAP FULL SCREEN) */
body::after {
    content: '';
    position: fixed;
    inset: 0;
    z-index: 1; 
    pointer-events: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext x='50' y='50' font-size='100' fill='rgba(0, 0, 0, 0)' stroke='rgba(0, 230, 255, 0.05)' stroke-width='0.5' text-anchor='middle'%3E%3C/text%3E%3C/svg%3E");
    background-size: 100px 100px;
    animation: matrixScroll 30s linear infinite;
    opacity: 0.15;
}

/* FIX 3: Container untuk memastikan rasio 9:16 (Mobile Optimized) */
#main-container {
    position: relative;
    width: 100vw;
    height: 100vh;
    max-width: 450px; /* Batasan Lebar Maksimum */
    max-height: 800px; /* Batasan Tinggi Maksimum */
    margin: 0 auto;
    overflow: hidden;
    background-color: transparent;
    z-index: 10;
}
@media (min-width: 640px) {
    /* Untuk Desktop/Tablet, batasi tampilan di tengah */
    #main-container {
        width: 100%;
        height: 100%;
        border-radius: 1rem;
        box-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
    }
    body {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background-color: #0d0d0d;
    }
}

/* FIX 4: Background Visuals (Cover, Scanline, Vignette) */
#cover-bg {
    background-image: url('https://files.catbox.moe/2wqmke.jpeg'); 
    background-size: cover;
    background-position: center;
    position: absolute;
    inset: 0;
    opacity: 0.2;
    z-index: 2;
}

#scanline-overlay {
    position: absolute;
    inset: 0;
    z-index: 4;
    pointer-events: none;
    background: repeating-linear-gradient(to bottom, transparent 0, transparent 2px, rgba(0, 0, 0, 0.2) 2px, rgba(0, 0, 0, 0.2) 3px);
    opacity: 0.5;
}
#vignette-overlay {
    position: absolute;
    inset: 0;
    z-index: 4;
    pointer-events: none;
    box-shadow: inset 0 0 200px rgba(0, 0, 0, 0.9);
}

/* FIX 5: Grid Background */
#grid-bg {
    position: absolute;
    inset: 0;
    z-index: 3;
    pointer-events: none;
    background-image: linear-gradient(rgba(0,255,255,0.05) 1px, transparent 1px),
                      linear-gradient(90deg, rgba(255,0,212,0.05) 1px, transparent 1px);
    background-size: 20px 20px;
    opacity: 0.8;
}

/* FIX 6: Typography and Neon Effects */
.font-orbitron {
    font-family: 'Orbitron', sans-serif;
}
.neon-title {
    color: var(--color-primary);
    text-shadow: 0 0 5px var(--color-primary), 0 0 10px var(--color-primary), 0 0 20px var(--color-primary);
    animation: neon-blink 1.5s infinite alternate;
}
.text-neon {
    color: var(--color-primary);
    text-shadow: 0 0 2px var(--color-primary);
}

/* Neon Blink Animation */
@keyframes neon-blink {
    0%, 100% {
        opacity: 1;
        text-shadow: 0 0 5px var(--color-primary), 0 0 10px var(--color-primary);
    }
    50% {
        opacity: 0.8;
        text-shadow: 0 0 2px var(--color-primary);
    }
}
@keyframes matrixScroll {
    from { background-position: 0 0; }
    to { background-position: 100px 100px; }
}

/* Status Pulse Animation */
@keyframes pulse-status {
    0% { box-shadow: 0 0 0 0 rgba(0, 255, 144, 0.7); }
    70% { box-shadow: 0 0 0 10px rgba(0, 255, 144, 0); }
    100% { box-shadow: 0 0 0 0 rgba(0, 255, 144, 0); }
}

/* FIX 7: Menu items hover & New Action Button Styling */
a.menu-item{transition:all 0.3s ease; position: relative;}
a.menu-item:hover{box-shadow:0 0 20px var(--color-primary),0 0 40px var(--color-secondary),0 0 60px #9d00ff;transform:scale(1.03);} /* Shadow use variables */
.menu-action-tag { border-color: var(--color-primary); }
.action-primary { border-color: var(--color-primary) !important; color: var(--color-primary); }
.action-secondary { border-color: var(--color-secondary) !important; color: var(--color-secondary); }
.action-success { border-color: var(--color-success) !important; color: var(--color-success); }

/* Status Bar */
.status-online { background-color: var(--color-success); color: var(--color-success); }
.status-offline { background-color: var(--color-secondary); color: var(--color-secondary); }

/* Terminal Log */
#terminal-log {
    max-height: 100px;
    overflow-y: hidden;
    font-size: 0.75rem;
    color: var(--color-success); 
    text-shadow: 0 0 2px var(--color-success);
}
@keyframes blink-cursor {
    50% { opacity: 0; }
}
.cursor-blink { animation: blink-cursor 1s step-end infinite; }

/* Modal/Overlay */
.modal-overlay {
    position: fixed;
    inset: 0;
    z-index: 70;
    background-color: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(8px);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}
.modal-overlay.active {
    opacity: 1;
    pointer-events: auto;
}
.modal-content {
    max-height: 90vh;
    overflow-y: auto;
}

/* ===== NEW: LOADING OVERLAY STYLING ===== */
#loading-overlay { opacity: 1; }
.hidden-loading { opacity: 0 !important; pointer-events: none; } 

/* Update posisi tombol warna */
#color-toggle-container {
    top: 0.5rem;
    right: 0.5rem; 
    position: fixed; 
    z-index: 50;
    transition: transform 0.3s ease;
}
@media (min-width: 640px) {
    #color-toggle-container {
        top: 1.5rem;
        right: 1.5rem;
    }
}
</style>
</head>
<body>

<div id="color-toggle-container" class="absolute z-50">
    <button id="color-toggle-btn" class="flex items-center gap-2 px-2 py-1 bg-black/40 backdrop-blur rounded-xl border border-[var(--color-secondary)] hover:scale-105 transition-transform duration-300">
        <span class="text-xs font-semibold tracking-wider text-white">ðŸŒˆ Switch Color</span>
    </button>
</div>

<div id="loading-overlay" class="fixed inset-0 z-[100] flex items-center justify-center bg-black/95 transition-opacity duration-1000">
    <div class="flex flex-col items-center">
        <h2 id="loading-text" class="text-3xl sm:text-4xl font-extrabold text-[var(--color-success)] tracking-wider" style="font-family: 'Orbitron', sans-serif; text-shadow: 0 0 10px var(--color-success), 0 0 20px var(--color-success);">INITIATING SEQUENCE...</h2>
        <div class="mt-4 w-40 h-1 bg-[var(--color-success)]/20 rounded overflow-hidden">
            <div id="loading-bar" class="h-full bg-[var(--color-success)] transition-all duration-300 ease-linear"></div>
        </div>
    </div>
</div>

<audio id="background-music" loop src="https://files.catbox.moe/gt808p.mp3"></audio>
<audio id="click-fx" src="https://files.catbox.moe/4e889j.mp3"></audio>
<audio id="glitch-fx" src="https://files.catbox.moe/s968l9.mp3"></audio>

<div id="main-container" class="relative z-10 text-white">
    <div id="cover-bg"></div>
    <div id="grid-bg"></div>
    <div id="tsparticles-gtzps" class="absolute inset-0 z-5"></div>
    <div id="scanline-overlay"></div>
    <div id="vignette-overlay"></div>
    
    <header class="p-4 sm:p-6 relative z-10">
        <div class="text-center mb-6">
            <h1 class="font-orbitron neon-title text-4xl sm:text-5xl font-extrabold tracking-widest leading-none">
                GTZS PRIVATE SERVER
            </h1>
            <p id="tagline" class="text-sm text-white/70 mt-2 h-5"></p>
        </div>
        
        <div class="grid grid-cols-3 gap-2 text-center text-xs sm:text-sm font-bold font-orbitron">
            <div class="p-2 border border-[var(--color-primary)]/20 bg-black/30 rounded-lg">
                <p class="text-white/60">PLAYERS</p>
                <p id="player-count" class="text-[var(--color-primary)]">...</p>
            </div>
            <div class="p-2 border border-[var(--color-primary)]/20 bg-black/30 rounded-lg relative">
                <p class="text-white/60">STATUS</p>
                <p id="server-status" class="text-[var(--color-success)]"></p>
                <span id="status-pulse" class="absolute w-2 h-2 rounded-full top-2 right-2 bg-[var(--color-success)]" style="animation: pulse-status 2s infinite;"></span>
            </div>
            <div class="p-2 border border-[var(--color-primary)]/20 bg-black/30 rounded-lg">
                <p class="text-white/60">LOAD</p>
                <div class="w-full h-2 bg-black/50 mt-1 rounded-full">
                    <div id="server-health-bar" class="h-full rounded-full transition-all duration-500" style="width: 50%; background-color: var(--color-primary);"></div>
                </div>
            </div>
        </div>
    </header>

    <main class="p-4 sm:p-6 relative z-10">
        <section id="menu-grid" class="grid grid-cols-2 gap-4">
            </section>
        
        <button id="about-btn" class="w-full mt-6 py-4 font-orbitron text-xl font-bold bg-black/50 border border-[var(--color-secondary)] hover:bg-[var(--color-secondary)]/20 transition-all duration-300 rounded-xl text-[var(--color-secondary)] shadow-lg shadow-transparent hover:shadow-[var(--color-secondary)]/50">
            [ ABOUT US ] / CARA JOIN
        </button>
    </main>

    <footer class="p-4 sm:p-6 relative z-10 mt-auto flex justify-between items-center text-xs sm:text-sm text-white/50 font-rajdhani">
        <div class="flex items-center gap-2">
            <button id="music-toggle-btn" class="px-2 py-1 bg-black/40 backdrop-blur rounded-xl border border-[var(--color-primary)] hover:scale-105 transition-transform duration-300">
                <span id="music-icon">ðŸŽ¶ ON</span>
            </button>
            <span id="live-clock" class="text-[var(--color-success)]" style="text-shadow: 0 0 5px var(--color-success), 0 0 10px var(--color-success);">00:00:00</span>
        </div>
        <p>GTZS PS | Â© <span id="current-year"></span> | V2.1.0</p>
    </footer>

    <div id="terminal-log-container" class="hidden sm:block absolute bottom-0 right-0 p-4 w-64 bg-black/70 border-t border-l border-[var(--color-success)]/30 rounded-tl-lg z-20">
        <p class="font-orbitron text-xs text-[var(--color-success)] mb-1">SYSTEM_LOG:</p>
        <div id="terminal-log">
            </div>
    </div>
</div>


<div id="about-modal" class="modal-overlay">
    <div class="flex justify-center items-center h-full p-4 sm:p-8">
        <div class="modal-content w-full max-w-lg bg-black/80 border border-[var(--color-primary)] shadow-lg shadow-[var(--color-primary)]/30 rounded-xl p-6 relative">
            <h2 class="font-orbitron neon-title text-2xl mb-4 text-center">CARA JOIN SERVER GTZS</h2>
            <ol class="space-y-3 list-decimal list-inside text-sm sm:text-base">
                <li class="text-[var(--color-primary)]">Pastikan Anda memiliki aplikasi game yang kompatibel.</li>
                <li class="text-[var(--color-primary)]">Download file Virtual Host (*.txt) dari link di menu.</li>
                <li class="text-[var(--color-primary)]">Buka aplikasi Virtual Host dan import file yang telah didownload.</li>
                <li class="text-[var(--color-primary)]">Aktifkan Virtual Host dan masuk ke dalam game.</li>
                <li class="text-[var(--color-primary)]">Jika status server di menu ini "Online", server siap dimasuki. Enjoy!</li>
            </ol>
            <button class="absolute top-2 right-4 text-xl text-white/70 hover:text-[var(--color-secondary)]" onclick="closeModal('about-modal')">&times;</button>
        </div>
    </div>
</div>

<div id="rules-modal" class="modal-overlay">
    <div class="flex justify-center items-center h-full p-4 sm:p-8">
        <div class="modal-content w-full max-w-lg bg-black/80 border border-[var(--color-secondary)] shadow-lg shadow-[var(--color-secondary)]/30 rounded-xl p-6 relative">
            <h2 class="font-orbitron text-2xl mb-4 text-center text-[var(--color-secondary)]" style="text-shadow: 0 0 5px var(--color-secondary);">SERVER RULES & POLICY</h2>
            <h3 class="font-bold mt-4 text-[var(--color-primary)]">1. Ketentuan Akun</h3>
            <ul class="list-disc list-inside ml-4 text-sm space-y-1">
                <li>Dilarang menggunakan ID yang menyinggung SARA/provokatif.</li>
                <li>Akun yang *inactive* lebih dari 3 bulan berisiko direset/dihapus.</li>
            </ul>
            <h3 class="font-bold mt-4 text-[var(--color-primary)]">2. Cheating & Bug Exploit</h3>
            <ul class="list-disc list-inside ml-4 text-sm space-y-1">
                <li>Penggunaan *cheat* atau modifikasi klien yang memberikan keuntungan dilarang keras dan berakibat *ban* permanen.</li>
                <li>Segera laporkan *bug* dan jangan dieksploitasi.</li>
            </ul>
            <h3 class="font-bold mt-4 text-[var(--color-primary)]">3. Etika Komunitas</h3>
            <ul class="list-disc list-inside ml-4 text-sm space-y-1">
                <li>Hormati sesama pemain dan Admin. Jaga perkataan.</li>
                <li>Dilarang melakukan spam di dalam game atau grup komunitas.</li>
            </ul>
            <h3 class="font-bold mt-4 text-[var(--color-primary)]">4. Kebijakan Donasi</h3>
            <ul class="list-disc list-inside ml-4 text-sm space-y-1">
                <li>Donasi bersifat sukarela dan tidak dapat ditarik kembali (non-refundable).</li>
                <li>Donasi tidak memberikan kekebalan dari hukuman *ban*.</li>
            </ul>
            <button class="absolute top-2 right-4 text-xl text-white/70 hover:text-[var(--color-secondary)]" onclick="closeModal('rules-modal')">&times;</button>
        </div>
    </div>
</div>

<div id="faq-modal" class="modal-overlay">
    <div class="flex justify-center items-center h-full p-4 sm:p-8">
        <div class="modal-content w-full max-w-lg bg-black/80 border border-[var(--color-success)] shadow-lg shadow-[var(--color-success)]/30 rounded-xl p-6 relative">
            <h2 class="font-orbitron text-2xl mb-4 text-center text-[var(--color-success)]" style="text-shadow: 0 0 5px var(--color-success);">FAQ (TANYA JAWAB UMUM)</h2>
            <div class="space-y-4 text-sm sm:text-base">
                <div>
                    <h3 class="font-bold text-[var(--color-primary)]">Q: Kenapa server saya tidak bisa connect?</h3>
                    <p class="ml-4 text-white/90">A: Pastikan Virtual Host Anda sudah aktif, dan periksa kembali Status Server di halaman ini. Coba *re-login* game Anda.</p>
                </div>
                <div>
                    <h3 class="font-bold text-[var(--color-primary)]">Q: Apakah server ini aman dari *reset*?</h3>
                    <p class="ml-4 text-white/90">A: Data di-backup secara berkala. Reset hanya dilakukan jika terjadi kerusakan data mayor atau *update* besar. Kami akan memberikan notifikasi jauh sebelumnya.</p>
                </div>
                <div>
                    <h3 class="font-bold text-[var(--color-primary)]">Q: Bagaimana cara mendapatkan item/mata uang langka?</h3>
                    <p class="ml-4 text-white/90">A: Ikuti event komunitas, daily reward, atau hubungi admin untuk info donasi.</p>
                </div>
            </div>
            <button class="absolute top-2 right-4 text-xl text-white/70 hover:text-[var(--color-secondary)]" onclick="closeModal('faq-modal')">&times;</button>
        </div>
    </div>
</div>

<div id="toast-notification" class="fixed bottom-4 left-1/2 transform -translate-x-1/2 px-4 py-2 bg-black/80 text-white rounded-full border border-[var(--color-primary)]/50 text-sm hidden z-50">
    Link disalin!
</div>

<div id="custom-context-menu" class="absolute bg-black/90 border border-[var(--color-secondary)] p-2 rounded-lg shadow-xl z-50 hidden text-sm">
    <a href="#" class="block px-3 py-1 text-[var(--color-primary)] hover:bg-white/10" onclick="copyServerLink(event)">COPY SERVER LINK</a>
    <a href="#" class="block px-3 py-1 text-[var(--color-secondary)] hover:bg-white/10" onclick="showModal('rules-modal'); event.preventDefault()">VIEW RULES</a>
    <a href="https://wa.me/6281234567890" target="_blank" class="block px-3 py-1 text-[var(--color-success)] hover:bg-white/10">CONTACT ADMIN</a>
    <a href="#" class="block px-3 py-1 text-[var(--color-warning)] hover:bg-white/10" onclick="showModal('faq-modal'); event.preventDefault()">SHOW FAQ</a>
</div>

<script>
// ===============================================
// ===== NEW: LOADING OVERLAY LOGIC (MODIFIED) =====
// ===============================================
const loadingOverlay = document.getElementById('loading-overlay');
const loadingText = document.getElementById('loading-text');
const loadingBar = document.getElementById('loading-bar');
const loadingMessages = ["CONNECTING TO PS CORE...", "LOADING ASSETS & CONFIG...", "ENCRYPTING DATA STREAM...", "INITIATING SEQUENCE..."];

function startLoadingSequence() {
    let messageIndex = 0;
    let progress = 0;

    const loadingInterval = setInterval(() => {
        progress += 10;
        loadingBar.style.width = `${progress}%`;
        
        if (progress > 100) {
            clearInterval(loadingInterval);
            return;
        }
        
        if (progress % 30 === 0 && messageIndex < loadingMessages.length) {
            scrambleText(loadingText, loadingMessages[messageIndex], 500); 
            messageIndex++;
        }
    }, 300);

    // Hide overlay after a delay
    setTimeout(() => {
        loadingOverlay.classList.add('hidden-loading');
    }, 4000); // 4 seconds total loading time
}


// ===============================================
// ===== NEW: COLOR TOGGLE LOGIC =====
// ===============================================
const colorToggleBtn = document.getElementById('color-toggle-btn');
const root = document.documentElement;
const gridBg = document.getElementById('grid-bg');
const liveClock = document.getElementById('live-clock');
const colorSchemes = [
    {
        name: 'CYAN/MAGENTA',
        primary: '#00e6ff', 
        secondary: '#ff00d4', 
        success: '#00ff90', 
        warning: '#ff8c00',
        borderColor: '#ff00d4' 
    },
    {
        name: 'GREEN/ORANGE',
        primary: '#00ff90',
        secondary: '#ff8c00', 
        success: '#00e6ff', 
        warning: '#ff00d4',
        borderColor: '#00ff90' 
    }
];
let currentColorIndex = 0;

function applyColorScheme(scheme) {
    root.style.setProperty('--color-primary', scheme.primary);
    root.style.setProperty('--color-secondary', scheme.secondary);
    root.style.setProperty('--color-success', scheme.success);
    root.style.setProperty('--color-warning', scheme.warning);
    
    colorToggleBtn.style.borderColor = scheme.borderColor; 

    // Update elemen spesifik (Grid dan Clock)
    if(scheme.name === 'GREEN/ORANGE') {
        gridBg.style.backgroundImage = 'linear-gradient(rgba(0,255,144,0.05) 1px, transparent 1px),linear-gradient(90deg, rgba(255,140,0,0.05) 1px, transparent 1px)';
        liveClock.style.color = scheme.success; 
        liveClock.style.textShadow = `0 0 5px ${scheme.success}, 0 0 10px ${scheme.success}`;
    } else {
        gridBg.style.backgroundImage = 'linear-gradient(rgba(0,255,255,0.05) 1px, transparent 1px),linear-gradient(90deg, rgba(255,0,212,0.05) 1px, transparent 1px)';
        liveClock.style.color = '#00ff90'; 
        liveClock.style.textShadow = `0 0 5px #00ff90, 0 0 10px #00ff90`;
    }
    
    showToast(`Color Scheme: ${scheme.name} Applied!`);
}

colorToggleBtn.onclick = () => {
    playClickSound();
    currentColorIndex = (currentColorIndex + 1) % colorSchemes.length;
    applyColorScheme(colorSchemes[currentColorIndex]);
    document.getElementById('color-toggle-container').style.transform = ''; 
};
// ===============================================
// ===============================================

// --- UTILITIES & EFFECTS ---

// 1. SOUND CONTROL
const bgMusic = document.getElementById('background-music');
const clickFX = document.getElementById('click-fx');
const glitchFX = document.getElementById('glitch-fx');
const musicToggleBtn = document.getElementById('music-toggle-btn');
const musicIcon = document.getElementById('music-icon');
let isMusicPlaying = false;

function playClickSound() {
    if (clickFX) {
        clickFX.currentTime = 0;
        clickFX.play().catch(e => console.log('Click sound failed to play:', e));
    }
}

function playGlitchSound() {
    if (glitchFX) {
        glitchFX.currentTime = 0;
        glitchFX.play().catch(e => console.log('Glitch sound failed to play:', e));
    }
}

function initializeMusic() {
    musicToggleBtn.addEventListener('click', () => {
        playClickSound();
        if (isMusicPlaying) {
            bgMusic.pause();
            musicIcon.textContent = 'ðŸ”‡ OFF';
            isMusicPlaying = false;
        } else {
            bgMusic.play().then(() => {
                musicIcon.textContent = 'ðŸŽ¶ ON';
                isMusicPlaying = true;
            }).catch(e => {
                console.log('Music autoplay failed. Please click to start.', e);
                musicIcon.textContent = 'âŒ Fail';
                isMusicPlaying = false;
            });
        }
    });

    // Attempt to start music muted to bypass browser autoplay policy
    bgMusic.volume = 0.3;
    bgMusic.play().then(() => {
        musicIcon.textContent = 'ðŸŽ¶ ON';
        isMusicPlaying = true;
    }).catch(e => {
        // Music blocked
        musicIcon.textContent = 'ðŸ”‡ OFF';
    });
}


// 2. TEXT SCRAMBLE EFFECT
function scrambleText(element, newText, duration = 300) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&*()_+';
    let originalText = element.textContent;
    let iterations = 0;
    const totalIterations = duration / 50; // Every 50ms

    const interval = setInterval(() => {
        element.textContent = Array.from(originalText)
            .map((char, index) => {
                if (index < iterations) {
                    return newText[index] || char;
                }
                return chars[Math.floor(Math.random() * chars.length)];
            })
            .join('');

        if (iterations >= newText.length) {
            clearInterval(interval);
            element.textContent = newText;
        }
        iterations += 1;
    }, 50);
}


// 3. TOAST NOTIFICATION
function showToast(message) {
    const toast = document.getElementById('toast-notification');
    toast.textContent = message;
    toast.classList.remove('hidden');
    
    setTimeout(() => {
        toast.classList.add('hidden');
    }, 2500);
}


// 4. MODAL CONTROL
function showModal(id) {
    playClickSound();
    document.getElementById(id).classList.add('active');
    // Tambahkan filter blur pada container utama saat modal aktif (desktop)
    const mainContainer = document.getElementById('main-container');
    if (mainContainer.style.filter === '') {
        mainContainer.style.filter = 'blur(5px)';
    }
}

function closeModal(id) {
    playClickSound();
    document.getElementById(id).classList.remove('active');
    document.getElementById('main-container').style.filter = '';
}

// Event listener untuk tombol About (untuk membuka modal)
document.getElementById('about-btn').addEventListener('click', (e) => {
    e.preventDefault();
    showModal('about-modal');
});


// 5. COPY SERVER LINK
function copyServerLink(e) {
    e.preventDefault();
    playGlitchSound();
    const serverLink = window.location.href; 
    navigator.clipboard.writeText(serverLink).then(() => {
        showToast('Server Link Disalin!');
        hideContextMenu();
    }).catch(err => {
        console.error('Failed to copy text: ', err);
        showToast('Gagal menyalin link.');
    });
}


// 6. MAGNETIC HOVER EFFECT (For modern desktop browsers)
const magneticButtons = ['music-toggle-btn', 'about-btn', 'color-toggle-btn'];
document.addEventListener('mousemove', (e) => {
    magneticButtons.forEach(id => {
        const btn = document.getElementById(id);
        if (!btn) return;
        
        const rect = btn.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        
        const deltaX = e.clientX - centerX;
        const deltaY = e.clientY - centerY;
        const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
        
        const maxDistance = 150; 
        const maxMovement = 10; 
        
        if (distance < maxDistance) {
            const movementX = (deltaX / maxDistance) * maxMovement;
            const movementY = (deltaY / maxDistance) * maxMovement;
            btn.parentNode.style.transform = `translate(${movementX}px, ${movementY}px)`;
        } else {
            btn.parentNode.style.transform = '';
        }
    });
});


// --- DATA & CORE FUNCTIONS ---

// 1. SERVER STATUS LOGIC
const serverStatusElement = document.getElementById('server-status');
const playerCountElement = document.getElementById('player-count');
const healthBar = document.getElementById('server-health-bar');
const statusPulse = document.getElementById('status-pulse');
let isServerOnline = true;

function updateServerStatus() {
    const playerCount = Math.floor(Math.random() * (500 - 150 + 1)) + 150; 
    const isOnline = Math.random() < 0.95; // 95% chance to be online
    const loadPercentage = Math.floor(Math.random() * (90 - 30 + 1)) + 30;

    playerCountElement.textContent = playerCount.toLocaleString();

    if (isOnline) {
        if (!isServerOnline) {
            // Server just came online
            scrambleText(serverStatusElement, 'ONLINE', 100);
            isServerOnline = true;
        } else {
            serverStatusElement.textContent = 'ONLINE';
        }
        
        serverStatusElement.className = 'status-online';
        statusPulse.className = 'absolute w-2 h-2 rounded-full top-2 right-2 status-online';
        statusPulse.style.animation = 'pulse-status 2s infinite';
    } else {
        if (isServerOnline) {
            // Server just went offline, play glitch sound
            playGlitchSound();
            scrambleText(serverStatusElement, 'OFFLINE', 300);
            isServerOnline = false;
        } else {
            serverStatusElement.textContent = 'OFFLINE';
        }
        
        serverStatusElement.className = 'status-offline';
        statusPulse.className = 'absolute w-2 h-2 rounded-full top-2 right-2 status-offline';
        statusPulse.style.animation = 'none';
    }

    // Health Bar logic
    healthBar.style.width = loadPercentage + '%';
    let color;
    if (loadPercentage < 50) {
        color = 'var(--color-primary)'; // Cyan/Safe
    } else if (loadPercentage < 80) {
        color = 'var(--color-warning)'; // Orange/Warning
    } else {
        color = 'var(--color-secondary)'; // Magenta/Critical
    }
    healthBar.style.backgroundColor = color;
}


// 2. LIVE CLOCK
function updateClock() {
    const now = new Date();
    const clockElement = document.getElementById('live-clock');
    
    // Gunakan zona waktu Indonesia (WIB)
    const options = { 
        hour: '2-digit', 
        minute: '2-digit', 
        second: '2-digit', 
        timeZone: 'Asia/Jakarta' 
    };
    clockElement.textContent = now.toLocaleTimeString('id-ID', options);
}


// 3. TAGLINE ANIMATION
const taglines = [
    "Welcome to GTZS Private Server ðŸŽ®",
    "Cyberpunk Racing, Optimized Mobile",
    "High Ping, High Risk, High Reward",
    "INIT: Core Systems Online...",
    "Join our WhatsApp Community Now!"
];
const taglineElement = document.getElementById('tagline');
let currentTaglineIndex = 0;

function startTickerAnimation(tags, element) {
    if (tags.length === 0) return;

    const updateTagline = () => {
        const newTag = tags[currentTaglineIndex];
        scrambleText(element, newTag, 500);
        currentTaglineIndex = (currentTaglineIndex + 1) % tags.length;
    };

    updateTagline(); // First run immediately
    setInterval(updateTagline, 5000); // Change every 5 seconds
}


// 4. TERMINAL LOG (DESKTOP ONLY)
const terminalLog = document.getElementById('terminal-log');
const logMessages = [
    "[INFO]: System check initiated...",
    "[INFO]: Server ping successful: 10ms",
    "[LOAD]: Player configuration loaded.",
    "[SEC]: Anti-DDoS Shield active.",
    "[CORE]: Welcome. Ready for input."
];
let currentLogIndex = 0;

function appendLogEntry(message) {
    const logDiv = document.createElement('div');
    logDiv.className = 'log-entry';
    terminalLog.appendChild(logDiv);
    
    // Add typing effect
    let charIndex = 0;
    const typeInterval = setInterval(() => {
        if (charIndex < message.length) {
            logDiv.textContent += message.charAt(charIndex);
            charIndex++;
            terminalLog.scrollTop = terminalLog.scrollHeight; // Auto scroll
        } else {
            clearInterval(typeInterval);
            logDiv.textContent += ' _'; // Add cursor simulation
            logDiv.lastChild.classList.add('cursor-blink');
        }
    }, 20); // Typing speed

    // Remove old logs if too many
    if (terminalLog.children.length > 5) {
        terminalLog.removeChild(terminalLog.children[0]);
    }
}

function startTerminalLog() {
    if (window.innerWidth < 640) return; // Skip on mobile

    const nextLog = () => {
        if (currentLogIndex >= logMessages.length) {
            currentLogIndex = 0; // Loop logs
        }
        appendLogEntry(logMessages[currentLogIndex]);
        currentLogIndex++;
        
        // Next log in 8-15 seconds
        setTimeout(nextLog, Math.random() * 7000 + 8000); 
    };

    // Start after a slight delay
    setTimeout(nextLog, 2000); 
}


// 5. CONTEXT MENU
const customContextMenu = document.getElementById('custom-context-menu');
document.addEventListener('contextmenu', (e) => {
    e.preventDefault();
    customContextMenu.style.top = `${e.clientY}px`;
    customContextMenu.style.left = `${e.clientX}px`;
    customContextMenu.style.display = 'block';

    // Pastikan menu tidak keluar dari viewport
    const menuWidth = customContextMenu.offsetWidth;
    const menuHeight = customContextMenu.offsetHeight;
    if (e.clientX + menuWidth > window.innerWidth) {
        customContextMenu.style.left = `${e.clientX - menuWidth}px`;
    }
    if (e.clientY + menuHeight > window.innerHeight) {
        customContextMenu.style.top = `${e.clientY - menuHeight}px`;
    }
});

document.addEventListener('click', () => {
    hideContextMenu();
});

function hideContextMenu() {
    customContextMenu.style.display = 'none';
}


// 6. MENU GRID DATA & RENDER
const menuData = [
    { title: "Server Rules & Policy", desc: "Baca sebelum bermain.", isRules: true, actionText: "VIEW RULES" },
    { title: "Report Bug & Error", desc: "Layanan 24 jam.", link: "https://wa.me/6281234567890", actionText: "WHATSAPP (Admin 1)" },
    { title: "FAQ (Tanya Jawab)", desc: "Pertanyaan umum.", isFAQ: true, actionText: "VIEW FAQ" },
    { title: "WhatsApp Community", desc: "Bergabung dengan grup.", link: "https://chat.whatsapp.com/L1nKgrUP", actionText: "JOIN GROUP" },
    { title: "Virtual Host", desc: "Download file config terbaru.", link: "https://www.mediafire.com/file/gtzsbeta.txt", actionText: "DOWNLOAD FILE", isDownload: true },
    { title: "Power Tunnel", desc: "Salin link Power Tunnel.", link: "https://t.me/PowerTunnelBot", actionText: "COPY LINK", isCopy: true },
    { title: "Contact Admin 1", desc: "Pertanyaan & Donasi.", link: "https://wa.me/6281234567890", actionText: "WHATSAPP", isSecondary: true },
    { title: "Contact Admin 2", desc: "Bantuan Teknis Cepat.", link: "https://wa.me/6285678901234", actionText: "WHATSAPP", isSecondary: true },
];

const menuGrid = document.getElementById('menu-grid');
menuGrid.innerHTML = menuData.map(item => {
    let actionClass = 'action-primary';
    if (item.isSecondary) actionClass = 'action-secondary';
    if (item.isRules || item.isFAQ) actionClass = 'action-success';

    let linkAttr = '';
    let clickHandler = '';

    if (item.isRules) {
        clickHandler = `onclick="showModal('rules-modal'); playClickSound();"`;
    } else if (item.isFAQ) {
        clickHandler = `onclick="showModal('faq-modal'); playClickSound();"`;
    } else if (item.isCopy) {
        clickHandler = `onclick="copyServerLink(event); event.preventDefault();"`;
    } else if (item.link) {
        linkAttr = `href="${item.link}" target="_blank"`;
        clickHandler = `onclick="playClickSound();"`;
    }

    const contentHTML = `
        <h3 class="font-orbitron font-bold text-xl line1">${item.title}</h3>
        <p class="text-white/70 line2">${item.desc}</p>
    `;

    // Menu Grid Render - [BG DIBUAT TRANSPARAN DENGAN MENGHILANGKAN bg-black/30 backdrop-blur]
    return `<a ${linkAttr} ${clickHandler} class='menu-item block p-4 sm:p-5 rounded-xl border border-[var(--color-primary)]/15 relative ${!item.isCopy && !item.isRules && !item.isFAQ ? '' : 'cursor-pointer'}'>` +
        contentHTML +
        `<div class='menu-action-tag absolute text-xs px-3 py-1 rounded-full bg-black/70 border ${actionClass} font-bold'>${item.actionText}</div>` +
        `</a>`;
}).join('');


// --- INITIALIZATION ---
window.onload = () => {
    // Set tahun saat ini
    document.getElementById('current-year').textContent = new Date().getFullYear();
    
    // Panggil updateStatus dan Clock agar berjalan
    updateClock();
    updateServerStatus();
    setInterval(updateClock, 1000); 
    // Health Bar/Glitch akan terupdate setiap 10 detik mengikuti Server Status
    setInterval(updateServerStatus, 10000); 
    
    // 1. Inisiasi Musik
    initializeMusic();
    
    // 2. Start Ticker/Tagline Animation
    startTickerAnimation(taglines, taglineElement);
    
    // 3. Start Terminal Log
    startTerminalLog();
    
    // 4. Start Loading Sequence BARU DITAMBAHKAN
    startLoadingSequence(); 

    // --- 5. TSParticles Configuration ---
    tsParticles.load({
      id: "tsparticles-gtzps",
      options: {
         particles: {
            color: { value: ["#00e6ff", "#ff00d4", "#00ff90"] },
            move: { direction: "none", enable: true, outModes: { default: "bounce" }, random: true, speed: 1.5, straight: false, trail: { enable: true, length: 10, fill: { color: "#ffffff" } } }, 
            number: { density: { enable: true, area: 800 }, value: 100 },
            opacity: { value: 0.7, animation: { enable: true, speed: 0.5, sync: false, startValue: "random", destroy: "min" } },
            shape: { type: "square" }, 
            size: { value: { min: 1, max: 4 } },
            links: { enable: false }
         },
         fullScreen: { enable: false }, // PENTING: Dibuat false agar menyesuaikan ukuran div induk
         detectRetina: true,
      },
    }).catch(error => {
        console.error("TSParticles failed to load:", error);
    });
};
</script>
</body>
</html>